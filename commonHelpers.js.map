{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nconst searchForm = document.querySelector(\".form\")\nconst imageGallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadButton = document.querySelector(\".load-button\")\n\nloader.style.display = \"none\";\nloadButton.style.display = \"none\";\n\nconst perPage = 40;\nlet inputValue;\nlet page = 1;\nlet galleryPage;\n\nasync function getImages (searchTerm, page) {\n  const BASE_URL = \"https://pixabay.com/api/\";\n  const API_KEY = \"41530032-c682b7302a1559a8b9f540776\";\n\n  try {\n    const response = await axios.get(`${BASE_URL}`, {params: {\n      key: API_KEY,\n      q: searchTerm,\n      image_type: \"photo\",\n      orientation: \"horizontal\",\n      safesearch: true,\n      page: page,\n      per_page: perPage,\n    }});\n\n    return response;\n\n  } catch (error) {\n    console.error(error);\n  }\n};\n\nsearchForm.addEventListener(\"submit\", (event) => {\n  event.preventDefault();\n  imageGallery.innerHTML = \"\";\n \n \n  inputValue = event.target.elements.search.value;\n  if (inputValue.trim() === '') {\n    loadButton.style.display = \"none\";\n    return;\n   }\n\n  loader.style.display = \"inline-block\";\n  loadButton.style.display = \"none\";\n\n  page = 1;\n\n  getImages(inputValue, page)\n    .then(response => {\n      loader.style.display = \"none\";\n      loadButton.style.display = \"flex\";\n      \n      if (!response.data.hits.length) {\n        iziToast.error({\n          message: \"Sorry, there are no images matching your search query. Please try again!\",\n          position: \"topRight\",\n          messageSize: \"11\",\n          backgroundColor: \"#EF4040\",\n          messageColor: \"#FFF\"\n        });\n        loadButton.style.display = \"none\";\n      }\n      \n      else if (response.data.hits.length < perPage) {\n        loadButton.style.display = \"none\";\n        iziToast.show({\n            message: \"We're sorry, but you've reached the end of search results.\",\n            position: \"topRight\",\n          });\n        \n        }\n\n     renderImage(response.data.hits);\n      \n      galleryPage = new SimpleLightbox('.gallery a', {\n        captions: true,\n        captionsData: 'alt',\n        captionDelay: 250,\n      });\n      galleryPage.refresh();\n\n      searchForm.reset();\n    }\n)\n    .catch((error) => {\n      loader.style.display = \"none\";\n      console.error(\"Error\");\n  })\n})\n\nloadButton.addEventListener(\"click\", () => {\n  try {\n    page += 1;\n\n    loadButton.style.display = \"none\";\n    loader.style.display = \"inline-block\";\n    \n    const itemHeight = document.querySelector(\".gallery-item\").getBoundingClientRect().height;\n\n    getImages(inputValue, page)\n      .then(response => {\n        renderImage(response.data.hits);\n\n        window.scrollBy(0, itemHeight * 2);\n\n        const totalPages = Math.ceil(response.data.totalHits / perPage);\n        \n        if (page === totalPages) {\n          loadButton.style.display = \"none\";\n          iziToast.show({\n            message: \"We're sorry, but you've reached the end of search results.\",\n            position: \"topRight\",\n          });\n          \n          loader.style.display = \"none\";\n          loadButton.style.display = \"none\";\n          return;\n        }\n        galleryPage.refresh();\n\n        loader.style.display = \"none\";\n        loadButton.style.display = \"flex\";\n      });\n    \n  } catch (error) {\n    console.log(error);\n  }\n});\n\nfunction renderImage(hits) {\n  const markup = hits.reduce((html, { largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => html + `\n            <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n              width=\"360\"\n            />\n          </a>\n          <div class=\"info\">\n            <div class=\"info-item\">\n              <h2>Likes</h2>\n              <p>${likes}</p>\n            </div>\n            <div class=\"info-item\">\n              <h2>Views</h2>\n              <p>${views}</p>\n            </div>\n            <div class=\"info-item\">\n              <h2>Comments</h2>\n              <p>${comments}</p>\n            </div>\n            <div class=\"info-item\">\n              <h2>Downloads</h2>\n              <p>${downloads}</p>\n            </div>\n          </div>\n        </li>`, \"\");\n  \n  imageGallery.insertAdjacentHTML(\"beforeend\", markup);\n}\n  \n\n"],"names":["searchForm","imageGallery","loader","loadButton","perPage","inputValue","page","galleryPage","getImages","searchTerm","BASE_URL","API_KEY","axios","error","event","response","iziToast","renderImage","SimpleLightbox","itemHeight","totalPages","hits","markup","html","largeImageURL","webformatURL","tags","likes","views","comments","downloads"],"mappings":"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"}